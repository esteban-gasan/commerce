{% extends 'auctions/layout.html' %}

{% block title %}{{ item.name }} | Auctions{% endblock title %}

{% block body %}

{% if user.is_authenticated  %}
    <form action="{% url 'auctions:item' item.id %}" method="post">
        {% csrf_token %}
        {% if user not in saved_by %}
            <button class="btn btn-info btn-sm" type="submit" name="add-watchlist">
                Add to Watchlist
            </button>
        {% else %}
            <button class="btn btn-outline-danger btn-sm" type="submit" name="rm-watchlist">
                Remove from Watchlist
            </button>
        {% endif %}
    </form>
{% endif %}

<img src="{{ item.image_url }}" alt="item_image">
<p>{{ item.name }}</p>
<p>{{ item.description }}</p>

{% if highest_bid %}
    <p>Current bid: {{ highest_bid.bid_amount }}</p>
{% else %}
    <p>Starting price: {{ item.starting_price }}</p>
{% endif %}

<p>{{ item.seller }}</p>

{% for category in categories %}
    <ul>{{ category }}</ul>
{% endfor %}

<p>{{ bids_count }} bid{{ bids_count|pluralize }} so far.</p>
{% if highest_bid.bidder == user %}
    <p>Your bid is the current bid.</p>
{% endif %}
<form action="{% url 'auctions:item' item.id %}" method="post">
    {% csrf_token %}
    {{ bid_form }}
    <button class="btn btn-primary" type="submit" name="place-bid">Place bid</button>
</form>

<h5>Comments</h5>
<form action="{% url 'auctions:item' item.id %}" method="post">
    {% csrf_token %}
    {{ comment_form }}
    <button class="btn btn-secondary" type="submit" name="post-comment">Post comment</button>
</form>

{% for comment in comments %}
<ul>
    {{ comment.author }}
    {{ comment.date_posted }}
    {{ comment.text }}
</ul>
{% endfor %}

{% endblock body %}
